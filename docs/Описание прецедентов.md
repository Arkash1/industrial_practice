

# Описание прецедентов

## Генерация QR-кода
**Актор:** Пользователь, Система

**Основной поток:**
1. Пользователь открывает главный экран (`HomeFragment`) со списком доступных типов QR-кодов.
2. Пользователь выбирает нужный тип (например, "Текст", "Wi-Fi", "URL").
3. Система открывает соответствующий экран ввода данных (например, `CreateTextFragment` или `CreateWifiFragment`).

**Возможные действия пользователя:**
- **Ввести данные**
  - Пользователь заполняет обязательные поля (текст сообщения, SSID сети и т.д.).
  - **Система:** проверяет корректность введенных данных (валидация).
- **Настроить внешний вид (Кастомизация)**
  - Пользователь раскрывает панель настроек.
  - Выбирает цвет переднего плана и фона.
- **Сгенерировать код**
  - Пользователь нажимает кнопку "Сгенерировать".
  - **Система:** кодирует данные, создает изображение (Bitmap) с учетом настроек цвета, сохраняет запись в историю и переходит на экран результата.

**Исключения:**
- Введены некорректные данные (пустое поле) — кнопка генерации неактивна или показана ошибка.
- Выбраны неконтрастные цвета — система показывает предупреждение, но разрешает генерацию.

**Результат:**
QR-код сгенерирован, отображен на экране результата и сохранен в истории.

---

## Сканирование QR-кода
**Актор:** Пользователь, Камера устройства

**Основной поток:**
1. Пользователь переходит на вкладку "Сканер" (`ScannerFragment`).
2. **Система:** проверяет наличие разрешения на использование камеры.
   - Если разрешения нет — запрашивает его.
   - Если разрешение есть — активирует камеру и запускает анализ изображения.
3. Пользователь наводит камеру на физический QR-код.
4. **Система:** распознает код, декодирует содержимое и автоматически определяет его тип.
5. **Система:** открывает всплывающее окно (`ScanResultBottomSheet`) с результатом и контекстными действиями.
6. **Система:** автоматически сохраняет отсканированный код в историю.

**Исключения:**
- Пользователь отказал в доступе к камере — система показывает сообщение о невозможности сканирования.
- Код поврежден или не читается — система продолжает попытки распознавания без результата.

**Результат:**
Информация из QR-кода получена, отображена пользователю и сохранена в истории.

---

## Управление историей
**Актор:** Пользователь

**Основной поток:**
1. Пользователь открывает вкладку "История" (`HistoryFragment`).
2. Система загружает список всех записей из локальной базы данных (`Room`).
3. Пользователь видит список с миниатюрами кодов, типом данных и датой создания.

**Возможные действия пользователя:**
- **Фильтрация и поиск**
  - Переключить вкладку (Все / Созданные / Сканированные / Избранное).
  - Ввести текст в строку поиска.
  - **Система:** обновляет список в реальном времени.
- **Просмотр деталей**
  - Нажать на элемент списка.
  - **Система:** открывает экран детального просмотра (`HistoryDetailFragment`) с крупным изображением кода.
- **Удаление записи**
  - Нажать кнопку удаления в детальном просмотре или использовать долгое нажатие в списке.
  - **Система:** удаляет запись из базы данных и обновляет список.
- **Добавление в избранное**
  - Нажать иконку "звезды".
  - **Система:** обновляет статус записи в базе данных.

**Результат:**
Пользователь нашел нужную информацию, удалил лишнее или отметил важное.

---

## Экспорт и обмен (Поделиться/Сохранить)
**Актор:** Пользователь, Внешнее приложение

**Основной поток:**
1. Пользователь находится на экране результата (после генерации, сканирования или из истории).
2. Пользователь выбирает действие:
   - **Сохранить в галерею:**
     - Система проверяет разрешение на запись (для старых версий Android).
     - Сохраняет изображение в папку изображений устройства.
     - Показывает уведомление об успехе.
   - **Поделиться:**
     - Система создает временный файл изображения.
     - Вызывает системное меню "Поделиться" (`Intent.ACTION_SEND`).
     - Пользователь выбирает приложение (мессенджер, почта).
     - Изображение передается во внешнее приложение.

**Результат:**
Изображение QR-кода сохранено в памяти устройства или передано другому пользователю.
